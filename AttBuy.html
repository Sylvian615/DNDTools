<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>购点器</title>
  <script src="resources/alpinejs_3.14.9.js" defer></script>
  <script src="resources/tailwindcss@4_1_10.js"></script>
  <link href="resources/daisyui@5_0_43.css" rel="stylesheet" type="text/css" />
<!--  <style>
    * {
      outline: 1px dashed red;
    }-->
  </style>
</head>
<body>
  <div class="flex flex-col items-center justify-center w-full min-h-screen m-1 rounded-md ">
    <div class="flex flex-col items-center justify-center w-full" x-data=attBuyFunc() x-init="remain_points = total_points">
      <div class="md:min-w-[400px] min-w-8/10 grid grid-cols-4 gap-4" >
        <label class="input col-span-2 place-self-end max-w-[150px]">
          <span class="label">总点数</span>
          <input type="text" class="text-center" x-model="total_points" @change="getRemainPoints()"/>
        </label>
        <label class="input col-span-2 place-self-end max-w-[150px]">
          <span class="label">剩余</span>
          <input type="number" class="text-center" x-model="remain_points"  />
        </label>
        <template x-for="(item, index) in att_value" :key="index"  >
          <div class="col-span-2  flex justify-self-end">
            <span class="label select-none w-[44px]" x-text="[att_name[index]]"></span>
            <div class="flex-1 join join-horizontal">
              <button class="btn join-item" @click="valueSubOne()" :disabled="subBtnDisable()">-</button>
              <input  class="input join-item max-w-[64px] text-center" type="text" x-model="[item]" readonly/>
              <button class="btn join-item" @click="valueAddOne()" :disabled="addBtnDisable()">+</button>
            </div>
          </div>
        </template>
        <button class="btn btn-success col-start-2 col-span-2" @click="rstAttValue()">重置</button>
      </div>

    </div>
  </div>
</body>

<script>
  function attBuyFunc() {
    return {
      total_points: '25',
      remain_points: '25',
      att_name: ['力量','敏捷','体质','智力','感知','魅力'],
      att_value: new Array(6).fill(10),
      att_consumed: new Array(6).fill(0),
      valueSubOne() {
        this.att_value[this.index] -= 1
        this.mapAtt2Point()
        this.getRemainPoints()
        },
      valueAddOne() {
        this.att_value[this.index] += 1
        this.mapAtt2Point()
        this.getRemainPoints()

      },
      addBtnDisable() {return this.att_value[this.index] >= 18},
      subBtnDisable() {return this.att_value[this.index] <= 7},
      rstAttValue() {
        this.att_value = new Array(6).fill(10)
        this.remain_points = this.total_points
      },
      mapAtt2Point() {
        const mapping = [-4, -2, -1, 0, 1, 2, 3, 5, 7, 10, 13, 17]
        const point_idx = this.att_value[this.index] - 7
        this.att_consumed[this.index] = mapping[point_idx]
/*        console.log(this.att_consumed[this.index])*/
      },
      getRemainPoints() {
        let acc = 0;
        this.att_consumed.forEach((item) => {acc += item})
        this.remain_points = this.total_points - acc
/*        console.log(this.remain_points)*/
      },

    }
  }
</script>
</html>