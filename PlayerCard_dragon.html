<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>游龙之年角色卡</title>
    <link rel="icon" href="assets/sylvian_256x.ico" type="image/x-icon">
    <script src="resources/alpinejs_collapse_3_x_x.js" defer></script>
    <script src="resources/alpinejs_3.14.9.js" defer></script>

    <script src="resources/tailwindcss@4_1_10.js"></script>
    <link
      href="resources/daisyui@5_0_43.css"
      rel="stylesheet"
      type="text/css"
    />
    <!--  <style>
    * {
      outline: 1px dashed red;
    }
  </style>-->
  </head>
  <body>
    <div
      id="app"
      class="flex flex-col items-center min-h-screen min-w-screen pr-1 pl-1 rounded-md bg-gray-100"
    >
      <div
        id="角色卡"
        class="min-w-[900px] m-[2px] min-h-[750px] flex flex-col bg rounded-md border p-1"
        x-data="PlayerCard()"
      >
        <div
          id="row1"
          class="w-full flex gap-2 rounded-md border-2 border-gray-200 p-1"
        >
          <div class="flex-none border rounded-md">
            <img
              :src="['assets/'+charTokenFilename]"
              alt="user_token"
              class="size-[192px] rounded-md"
            />
          </div>
          <div
            id="角色信息"
            class="flex-5 border rounded-md flex w-full flex-col"
          >
            <div
              class="container min-h-[40px] flex justify-center items-center bg-white rounded-t"
            >
              <h1 class="text-xl" x-text="charName">希尔维安</h1>
            </div>
            <div
              class="container h-full flex-auto flex flex-col pr-1 pl-1 pb-1 gap-1"
            >
              <div class="container h-full flex">
                <div
                  class="w-[80px] flex-none flex items-center justify-center rounded-l bg-gray-300"
                >
                  种族
                </div>
                <div
                  class="flex-auto flex items-center justify-center rounded-r bg-gray-200"
                  x-text="charRace"
                >
                  精灵-日精灵
                </div>
              </div>
              <div class="container h-full flex">
                <div
                  class="w-[80px] flex-none flex items-center justify-center rounded-l bg-gray-300"
                >
                  年龄
                </div>
                <div
                  class="flex-auto flex items-center justify-center rounded-r bg-gray-200"
                  x-text="charAge"
                >
                  约160岁
                </div>
              </div>
              <div class="container h-full flex">
                <div
                  class="w-[80px] flex-none flex items-center justify-center rounded-l bg-gray-300"
                >
                  职业
                </div>
                <div
                  class="flex-auto max-w-full flex items-center justify-center rounded-r bg-gray-200"
                  x-text="charJob"
                >
                  5法师/4观星者/5银月城法术守卫
                </div>
              </div>
              <div class="container h-full flex">
                <div
                  class="w-[80px] flex-none flex items-center justify-center rounded-l bg-gray-300"
                >
                  阵营
                </div>
                <div
                  class="flex-auto max-w-full flex items-center justify-center rounded-r bg-gray-200"
                  x-text="charAlignment"
                >
                  混乱善良
                </div>
              </div>
              <div class="container h-full flex">
                <div
                  class="w-[80px] flex-none flex items-center justify-center rounded-l bg-gray-300"
                >
                  信仰
                </div>
                <div
                  class="flex-auto flex items-center justify-center rounded-r bg-gray-200"
                  x-text="charBelief"
                >
                  普露拉
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="属性值" class="rounded-md border-2 border-gray-200 p-1">
          <div class="min-w-full flex flex-col justify-center cursor-pointer">
            <div
              class="min-w-full text-center bg-gray-400 rounded-t-md"
              @click="[contentShow = !contentShow]"
            >
              属性值
            </div>
            <div
              class="text-center border rounded-b-md p-1 flex flex-col gap-2"
            >
              <div class="grid grid-cols-6 gap-1">
                <template x-for="idx in [0,1,2,3,4,5]" :key="idx">
                  <div class="container h-full flex">
                    <div class="container h-full flex-1 flex p-2">
                      <div
                        class="w-[50px] flex-none flex items-center justify-center border rounded-l-xl bg-gray-300"
                        x-text="charAttName[idx]"
                      >
                        力量
                      </div>
                      <div
                        class="tooltip tooltip-bottom flex-auto flex items-center justify-center border-t border-b bg-gray-200"
                      >
                        <div x-text="charAttValue[idx].attValue"></div>
                        <div class="tooltip-content">
                          <div
                            class="whitespace-pre-wrap text-start"
                            x-text="[charAttValue[idx].attDetails]"
                          ></div>
                        </div>
                      </div>
                      <div
                        class="w-[34px] flex items-center justify-center border rounded-r-xl bg-gray-100"
                        x-text="charAttModifier[idx]"
                      >
                        +0
                      </div>
                    </div>
                  </div>
                </template>
              </div>
            </div>
          </div>
        </div>

        <div class="w-full rounded-md border-2 border-gray-200 p-1">
          <div class="grid grid-cols-6 grid-rows-2 gap-2">
            <div class="col-span-3">
              <h1 class="text-center rounded-t-md bg-gray-500">防御</h1>
              <div class="flex rounded-b-md border">
                <div class="flex-1 flex flex-col justify-center">
                  <div class="text-center bg-gray-300">正常AC</div>
                  <div
                    class="tooltip tooltip-bottom text-center"

                  >
                    <div x-text="[charAC.totalAC]">xx</div>
                    <div class="tooltip-content">
                      <div
                        class="whitespace-pre-line text-start"
                        x-text="[charAC.totalACDetails]"
                      ></div>
                    </div>
                  </div>
                </div>
                <div class="flex-1 flex flex-col justify-center">
                  <div class="tooltip tooltip-bottom  text-center bg-gray-300" data-tip="失去护甲/盾牌/天生防御加值">接触AC</div>
                  <div class="text-center" x-text="[charAC.touchAC]">19</div>
                </div>
                <div class="flex-1 flex flex-col justify-center">
                  <div class="tooltip tooltip-bottom text-center bg-gray-300" data-tip="失去敏捷加值">措手不及</div>
                  <div
                    class="text-center"
                    x-text="[charAC.totalAC - charAttModifier[1]]"
                  >
                    20
                  </div>
                </div>
              </div>
            </div>
            <div class="col-span-3">
              <h1 class="text-center rounded-t-md bg-gray-500" ><div class="tooltip tooltip-bottom " data-tip="成长：强2+等级/2；弱0+等级/3">豁免</div></h1>
              <div class="flex rounded-b-md border">
                <div class="flex-1 flex flex-col justify-center">
                  <div class="text-center bg-gray-300">强韧</div>
                  <div
                    class="text-center"
                    x-text="[charSavingThrows.Fortitude]"
                  >
                    18
                  </div>
                </div>
                <div class="flex-1 flex flex-col justify-center">
                  <div class="text-center bg-gray-300">反射</div>
                  <div class="text-center" x-text="[charSavingThrows.Reflex]">
                    19
                  </div>
                </div>
                <div class="flex-1 flex flex-col justify-center">
                  <div class="text-center bg-gray-300">意志</div>
                  <div class="text-center" x-text="[charSavingThrows.Will]">
                    20
                  </div>
                </div>
              </div>
            </div>
            <div class="col-span-3">
              <h1 class="text-center rounded-t-md bg-gray-500">战技</h1>
              <div class="flex rounded-b-md border">
                <div class="flex-1 flex flex-col justify-center">
                  <div class="tooltip tooltip-bottom text-center bg-gray-300" data-tip="CMB = BAB + 力量修正 + 体型修正">CMB</div>
                  <div class="text-center" x-text="charCMB">xx</div>
                </div>
                <div class="flex-1 flex flex-col justify-center">
                  <div class="tooltip tooltip-bottom text-center bg-gray-300" data-tip="CMD = 10 + BAB + 力量修正 + 敏捷修正 + 体型修正">CMD</div>
                  <div class="text-center" x-text="charCMD">xx</div>
                </div>
                <div class="flex-1 flex flex-col justify-center">
                  <div class="text-center bg-gray-300">失敏CMD</div>
                  <div
                    class="text-center"
                    x-text="[charCMD - charAttModifier[1]]"
                  >
                    xx
                  </div>
                </div>
              </div>
            </div>
            <div class="col-span-3">
              <h1 class="text-center rounded-t-md bg-gray-500">速度</h1>
              <div class="flex rounded-b-md border">
                <div class="flex-1 flex flex-col justify-center">
                  <div class="text-center bg-gray-300">地面</div>
                  <div class="text-center" x-text="[charSpeed[0]]">30</div>
                </div>
                <div class="flex-1 flex flex-col justify-center">
                  <div class="text-center bg-gray-300">飞行</div>
                  <div class="text-center" x-text="[charSpeed[1]]">19</div>
                </div>
                <div class="flex-1 flex flex-col justify-center">
                  <div class="text-center bg-gray-300">飞行机动性</div>
                  <div class="text-center" x-text="charFlyType">一般</div>
                </div>
              </div>
            </div>
          </div>
          <div class="grid grid-cols-6 gap-1 mt-1">
            <div class="col-span-1 flex flex-col justify-center">
              <div class="text-center bg-gray-400 rounded-t-md">生命值</div>
              <div class="tooltip tooltip-bottom text-center border rounded-b-md" >
                <div x-text="[charHP.HP]"></div>
                <div class="tooltip-content" x-text="[charHP.HPDetails]"></div>
              </div>
            </div>
            <div class="col-span-1 flex flex-col justify-center">
              <div class="text-center bg-gray-400 rounded-t-md">先攻</div>
              <div
                class="text-center border rounded-b-md tooltip tooltip-bottom"
              >
                <div x-text="[charInitiative.Initiative]"></div>
                <div class="tooltip-content">
                  <div
                    class="whitespace-pre-wrap text-start"
                    x-text="[charInitiative.InitiativeDetails]"
                  >
                    先攻构成
                  </div>
                </div>
              </div>
            </div>
            <div class="col-span-1 flex flex-col justify-center">
              <div class="tooltip tooltip-bottom  text-center bg-gray-400 rounded-t-md" data-tip="成长：强1*等级；中3/4*等级；弱1/2*等级">BAB</div>
              <div class="text-center border rounded-b-md" x-text="charBAB">
                22
              </div>
            </div>
            <div class="col-span-1 flex flex-col justify-center">
              <div class="text-center bg-gray-400 rounded-t-md">法术抗力</div>
              <div class="text-center border rounded-b-md" x-text="charSR">
                xx
              </div>
            </div>
            <div class="col-span-1 flex flex-col justify-center">
              <div class="tooltip tooltip-bottom text-center bg-gray-400 rounded-t-md" data-tip="近战AB=BAB+力量修正+体型修正">近战命中</div>
              <div
                class="text-center border rounded-b-md"
                x-text="[charAB.nearAB]"
              >
                xx
              </div>
            </div>
            <div class="col-span-1 flex flex-col justify-center">
              <div class="tooltip tooltip-bottom  text-center bg-gray-400 rounded-t-md" data-tip="远程AB=BAB+敏捷修正+体型修正">远程命中</div>
              <div
                class="text-center border rounded-b-md"
                x-text="[charAB.farAB]"
              >
                xx
              </div>
            </div>
          </div>
        </div>
        <div
          id="角色语言"
          class="w-full flex-col gap-3 rounded-md border-2 border-gray-200 p-1"
          x-data="{contentShow:true}"
        >
          <div class="flex flex-col justify-center cursor-pointer">
            <div class="text-center bg-gray-400 rounded-t-md" @click="[contentShow = !contentShow]">语言</div>
            <div
              class="text-center border rounded-b-md grid grid-cols-8 place-items-center gap-1 p-1"
              x-show="contentShow" x-collapse x-cloak
            >
              <template x-for="(item, index) in charLanguage" :key="index">
                <div
                  class="col-span-1 badge badge-neutral badge-outline"
                  x-text="item"
                ></div>
              </template>
            </div>
          </div>
        </div>
        <div
          id="角色特性"
          class="w-full flex-col gap-3 rounded-md border-2 border-gray-200 p-1"
          x-data="{contentShow:true}"
        >
          <div class="flex flex-col justify-center cursor-pointer">
            <div
              class="text-center bg-gray-400 rounded-t-md"
              @click="[contentShow = !contentShow]"
            >
              特性
            </div>
            <div
              class="text-center border rounded-b-md p-2 flex flex-col gap-2"
              x-show="contentShow"
              x-collapse
              x-cloak
            >
              <template x-for="(item, index) in charSpecial" :key="index">
                <div>
                  <button
                    class="bg-gray-300 min-w-full rounded-2xl text-start pl-4"
                    :onclick="['char_special_modal_'+(index+1)+'.showModal()']"
                    x-text="[item[0]+'—'+item[1].source+'—'+item[1].action+'—'+item[1].numbers]"
                  >
                    open modal
                  </button>
                  <dialog :id="['char_special_modal_'+(index+1)]" class="modal">
                    <div
                      class="modal-box p-2 min-w-2/5 max-w-3/5 min-h-2/5 max-h-2/5 bg-white rounded-md row-start-1 col-start-1"
                    >
                      <h3 class="text-lg font-bold" x-text="[item[0]]">
                        Hello!
                      </h3>
                      <p
                        class="py-4 whitespace-pre-line text-start p-2"
                        x-text="item[1].description"
                      ></p>
                    </div>
                    <form method="dialog" class="modal-backdrop">
                      <button>close</button>
                    </form>
                  </dialog>
                </div>
              </template>
            </div>
          </div>
        </div>
        <div
          id="角色类法术能力"
          class="w-full flex-col gap-3 rounded-md border-2 border-gray-200 p-1"
          x-data="{contentShow:true}"
        >
          <div class="flex flex-col justify-center cursor-pointer">
            <div
              class="text-center bg-gray-400 rounded-t-md"
              @click="[contentShow = !contentShow]"
            >
              类法术能力
            </div>
            <div
              class="text-center border rounded-b-md p-2 flex flex-col gap-2"
              x-show="contentShow"
              x-collapse
              x-cloak
            >
              <template x-for="(item, index) in charSpellLike" :key="index">
                <div>
                  <button
                    class="bg-gray-300 min-w-full rounded-2xl text-start pl-4"
                    :onclick="['char_spell_like_modal_'+(index+1)+'.showModal()']"
                    x-text="[item[0]+'—'+item[1].source+'—'+item[1].action+'—'+item[1].numbers]"
                  >
                    open modal
                  </button>
                  <dialog
                    :id="['char_spell_like_modal_'+(index+1)]"
                    class="modal"
                  >
                    <div
                      class="modal-box p-2 min-w-2/5 max-w-3/5 min-h-2/5 max-h-2/5 bg-white rounded-md row-start-1 col-start-1"
                    >
                      <h3 class="text-lg font-bold" x-text="[item[0]]">
                        Hello!
                      </h3>
                      <p
                        class="py-4 whitespace-pre-line text-start p-2"
                        x-text="item[1].description"
                      ></p>
                    </div>
                    <form method="dialog" class="modal-backdrop">
                      <button>close</button>
                    </form>
                  </dialog>
                </div>
              </template>
            </div>
          </div>
        </div>
        <div
          id="角色专长"
          class="w-full flex-col gap-3 rounded-md border-2 border-gray-200 p-1"
          x-data="{contentShow:true}"
        >
          <div class="flex flex-col justify-center cursor-pointer">
            <div
              class="text-center bg-gray-400 rounded-t-md"
              @click="[contentShow = !contentShow]"
            >
              专长
            </div>
            <div
              class="text-center border rounded-b-md p-2 grid grid-cols-2 gap-2"
              x-show="contentShow"
              x-collapse
              x-cloak
            >
              <template x-for="(item, index) in charFeats" :key="index">
                <div>
                  <button
                    class="bg-gray-300 min-w-full rounded-2xl text-center"
                    :onclick="['char_feats_modal_'+(index+1)+'.showModal()']"
                    x-text="[item[0]+'—'+item[2]]"
                  >
                    open modal
                  </button>
                  <dialog :id="['char_feats_modal_'+(index+1)]" class="modal">
                    <div
                      class="modal-box p-2 min-w-2/5 max-w-9/10 min-h-2/5 max-h-2/5 bg-white rounded-md row-start-1 col-start-1"
                    >
                      <h3 class="text-lg font-bold" x-text="item[0]">Hello!</h3>
                      <p
                        class="py-4 whitespace-pre-line text-start p-2"
                        x-text="item[1].description"
                      ></p>
                    </div>
                    <form method="dialog" class="modal-backdrop">
                      <button>close</button>
                    </form>
                  </dialog>
                </div>
              </template>
            </div>
          </div>
        </div>
        <div
          id="角色招式"
          class="w-full flex-col gap-3 rounded-md border-2 border-gray-200 p-1"
          x-data="{contentShow:true}"
        >
          <div class="flex flex-col justify-center cursor-pointer">
            <div
              class="text-center bg-gray-400 rounded-t-md"
              @click="[contentShow = !contentShow]"
            >
              招式
            </div>
            <div
              class="text-center border rounded-b-md p-2 flex flex-col gap-2"
              x-show="contentShow"
              x-collapse
              x-cloak
            >
              <div class="flex justify-start h-[24px] border rounded-md pl-4">
                <div class="flex-1 flex" x-data="charSpellNum">
                  <span>已知招式数：</span>
                  <span x-text="[charSpellNum[0]]"></span>
                </div>
                <div class="flex-1 flex">
                  <span>可准备招式数：</span>
                  <span x-text="[charSpellNum[1]]"></span>
                </div>
                <div class="flex-1 flex">
                  <span>已知步法数：</span>
                  <span x-text="[charSpellNum[2]]"></span>
                </div>
              </div>
              <template x-for="(item, index) in charSpells" :key="index">
                <div>
                  <button
                    class="bg-gray-300 min-w-full rounded-2xl text-start pl-4"
                    :onclick="['char_spells_modal_'+(index+1)+'.showModal()']"
                    x-text="[`${item[1].title}-${item[1].school}-${item[1].action}-${item[1].level}`]"
                  >
                    open modal
                  </button>
                  <dialog :id="['char_spells_modal_'+(index+1)]" class="modal">
                    <div
                      class="modal-box p-2 min-w-2/5 max-w-3/5 min-h-2/5 bg-white rounded-md row-start-1 col-start-1"
                    >
                      <h3 class="text-lg font-bold" x-text="item[0]">Hello!</h3>
                      <p
                        class="py-4 whitespace-pre-line text-start p-2"
                        x-text="item[1].description"
                      ></p>
                    </div>
                    <form method="dialog" class="modal-backdrop">
                      <button>close</button>
                    </form>
                  </dialog>
                </div>
              </template>
            </div>
          </div>
        </div>
        <div
          id="角色技能"
          class="w-full flex-col gap-3 rounded-md border-2 border-gray-200 p-1"
          x-data="{contentShow:true}"
        >
          <div class="flex flex-col justify-center cursor-pointer">
            <div
              class="text-center bg-gray-400 rounded-t-md"
              @click="[contentShow = !contentShow]"
            >
              技能
            </div>
            <div
              class="text-center border rounded-b-md p-2 flex flex-col gap-2"
              x-show="contentShow"
              x-collapse
              x-cloak
            >
              <div class="flex flex-col justify-center gap-2">
                <div class="flex justify-center items-center">
                  <div class="min-w-[100px] rounded-md border pr-1 pl-1">
                    #受训技能 *本职技能
                  </div>
                  <div class="flex-1 flex justify-center items-center">
                    <div class="min-w-[150px] rounded-l-md border bg-gray-500">
                      总技能点
                    </div>
                    <div
                      class="min-w-[100px] rounded-r-md border-r border-t border-b"
                      x-text="charSkillTotalPoints"
                    >
                      123
                    </div>
                  </div>
                  <div class="flex-1 flex justify-center items-center">
                    <div class="min-w-[150px] rounded-l-md border bg-gray-500">
                      剩余技能点
                    </div>
                    <div
                      class="min-w-[100px] rounded-r-md border-r border-t border-b"
                      x-text="[charSkillTotalPoints-charSkillUsedPoints]"
                    >
                      123
                    </div>
                  </div>
                </div>
                <div class="grid grid-cols-4 gap-2" x-data="PlayerSkills()">
                  <template x-for="(item, index) in charSkills" :key="index">
                    <div class="col-span-1">
                      <div class="flex">
                        <div
                          class="min-w-[120px] bg-gray-400 rounded-l-2xl"
                          x-text="[setSkillNameText(item)]"
                        >
                          技能名
                        </div>
                        <div class="flex-2 bg-gray-300" x-text="item[1]"></div>
                        <div
                          class="flex-1 bg-gray-200 border-r"
                          x-text="item[3]"
                        >
                          投入技能点
                        </div>
                        <div
                          class="flex-1 bg-gray-200 rounded-r-2xl"
                          x-text="setSkillValue(item)"
                        >
                          技能加值
                        </div>
                      </div>
                    </div>
                  </template>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="js/PlayerCard/ValueMap.js"></script>
    <script src="js/PlayerCard/SpecialList.js"></script>
    <script src="js/PlayerCard/SpellLikeList.js"></script>
    <script src="js/PlayerCard/FeatList.js"></script>
    <script src="js/PlayerCard/SpellList.js"></script>
    <script src="js/PlayerCard/SkillList.js"></script>
    <script src="js/PlayerCard/CardInfos.js"></script>
    <script src="js/PlayerCard/CardValueCalc.js"></script>
    <script src="js/PlayerCard/PlayerCard_dragon.js"></script>
  </body>
</html>
